# 핵심 문제해결 전략

## 1. 구조 설계
- 프로젝트의 패키지 구조는 비즈니스 도메인 별 상위 패키지를 만들고, 각 도메인 내에는 다음과 같은 하위 패키지들을 생성하였습니다.
  - controller
    - API 요청을 처리하는 컨트롤러 클래스들이 위치합니다. 
  - domain
    - 도메인 모델 클래스들이 위치합니다.
  - repository
    - 데이터베이스 접근을 위한 리포지토리 인터페이스들이 위치합니다.
  - service
    - 비즈니스 로직을 처리하는 서비스 클래스들이 위치합니다.
- 주어진 요구사항을 충족하기 위해 아래 다섯 가지 테이블을 설계했습니다.
  - `user`, `room`, `settlement_request`, `settlement_detail`, `configuration`
  - `SettlementRequest` 엔티티와 `SettlementDetail` 엔티티는 양방향 연관관계를 맺고 있습니다.
  - 이외 테이블 간에는 연관관계가 없으며, 데이터가 필요할 시 aggregate root를 통해 데이터를 조회하고 관리합니다.

## 2. 기능 구현
- 총 6가지의 기능을 구현하였고, 이 중 4개의 기능은 API를 제공합니다.
1) 정산 요청 생성 내역 조회 API (`GET /settlements/requests`)
2) 정산 요청 받은 내역 조회 API (`GET /settlements/received`)
3) 정산 요청 생성 API (`POST /settlements/requests`)
4) 정산하기 API (`POST /settlements/{settlementRequestId}/settle`)
5) 정산 완료 처리
   1) Spring Event로 처리합니다.
   2) 정산(송금)이 완료된 경우 정산 상태를 업데이트합니다.
6) 미정산 인원들에게 리마인드 알림 발송
   1) 매일 자정 실행되는 스케줄러를 통해 미정산 인원들에게 리마인드 알림을 발송합니다.
   2) 미정산 상태인 정산 상세 내역을 조회합니다. 이때, 두 가지 조건을 고려합니다. 
      1) 마지막 리마인드 알림을 받지 않은 경우 
      2) 마지막 리마인드 알림 시간이 현재 시간보다 이전인 경우 
   3) 조회된 정산 상세 내역에 해당하는 사용자에게 리마인드 알림을 보냅니다.
   4) 리마인드 알림을 보낸 시간을 업데이트합니다.

## 3. 외부 의존성 처리
- 실제 금액 이체, 알림 발송 등 외부 의존성이 필요한 기능은 Interface와 Mock으로 구현하였습니다.
- 임시 데이터베이스로 H2 Database를 사용하였습니다.

## 4. 단위 테스트
- db 로직을 제외한 비즈니스 로직에 대해 단위 테스트를 작성하였습니다.

## 5. 비동기 처리
- 알림 발송 기능을 비동기로 처리할지 여부는 알림 발송의 성공 여부 처리와 시스템 전체 성능에 미치는 영향을 고려하여 결정하였습니다.

## 6. 개선 방안
- 메세지 큐를 도입하여 알림 발송 등의 비동기 처리를 더욱 효율적으로 처리할 수 있습니다.
- 캐싱을 도입하여 자주 사용되는 데이터의 조회 성능을 향상시킬 수 있습니다.
- 대량의 트래픽에 대응하기 위해 로드 밸런싱, 샤딩 등의 기술을 도입할 수 있습니다.
